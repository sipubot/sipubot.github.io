var SipuDiet=function(l,b,x){function u(){b(a.Button.cancel).click(function(){window.history.back()});Object.keys(a.ButtonModal).map(function(c){b(a.ButtonModal[c]).click(function(){switch(c){case "SubFoodFood":n(a.Div.ModalFoodExec,a.ButtonModal[c]);break;case "SubFoodExec":n(a.Div.ModalFoodExec,a.ButtonModal[c]);break;case "SubWeightWeight":n(a.Div.ModalWeight,a.ButtonModal[c]);break;case "SubCategory":n(a.Div.ModalCategory,a.ButtonModal[c])}})});Object.keys(a.Button).map(function(c){"cancel"!==
c&&b(a.Button[c]).click(function(){k(a.Button[c])})});Object.keys(a.Input).filter(function(a){return-1===a.indexOf("Day")}).map(function(c){b(a.Input[c]).keydown(function(b){if(13==b.which)switch(c){case "SubmitFoodExecSearch":k(a.Button.SubmitFoodExecSearch);break;case "SubmitFoodExecQt":k(a.Button.SubmitFoodExec);break;case "SubmitFoodExecQt":k(a.Button.SubmitWeight);break;case "SubmitCategoryExecValue":k(a.Button.SubmitCategoryExec);break;case "SubmitCategoryFoodValue":k(a.Button.SubmitCategoryFood)}})});
b(a.Input.SubFoodDay).datepicker();b(a.Input.SubFoodDay).datepicker("option","dateFormat","yy-mm-dd");b(a.Input.SubWeightDay).datepicker();b(a.Input.SubWeightDay).datepicker("option","dateFormat","yy-mm-dd");b(a.Input.SubmitFoodExecDay).datepicker();b(a.Input.SubmitFoodExecDay).datepicker("option","dateFormat","yy-mm-dd");b(a.Input.SubmitWeightDay).datepicker();b(a.Input.SubmitWeightDay).datepicker("option","dateFormat","yy-mm-dd")}function n(c,g){if(g===a.ButtonModal.SubFoodExec){b(a.Div.ModalFoodExec).find("p").text(d.TextVal.SubmitExec);
var e=b(a.Table.SubmitFoodExec).find("tbody");e.empty();b(e).append("<tr><th>\uc120\ud0dd</th><th>\ud6a8\uc728(kcal/~)</th>");b(a.Input.SubmitFoodExecQt).attr("placeholder","~ km")}g===a.ButtonModal.SubFoodFood&&(b(a.Div.ModalFoodExec).find("p").text(d.TextVal.SubmitFood),e=b(a.Table.SubmitFoodExec).find("tbody"),e.empty(),b(e).append("<tr><th>\uc120\ud0dd</th><th>\ud6a8\uc728(kcal/~)</th>"),b(a.Input.SubmitFoodExecQt).attr("placeholder","~ x 100g"));window.location.href=c}function k(c){switch(c){case a.Button.SubFoodSearch:c=
{RQ:d.ajaxVal.Food,DATE:b(a.Input.SubFoodDay).val()};f(d.ajaxLink.Food,c,a.Button.SubFoodSearch,h);c={RQ:d.ajaxVal.Exec,DATE:b(a.Input.SubFoodDay).val()};f(d.ajaxLink.Exec,c,a.Button.SubExecSearch,h);break;case a.Button.SubWeightSearch:c={RQ:d.ajaxVal.Weight,DATE:b(a.Input.SubWeightDay).val()};f(d.ajaxLink.Weight,c,a.Button.SubWeightSearch,h);break;case a.Button.MainFood:c={RQ:d.ajaxVal.Food,DATE:b(a.Input.SubFoodDay).val()};f(d.ajaxLink.Food,c,a.Button.SubFoodSearch,h);c={RQ:d.ajaxVal.Exec,DATE:b(a.Input.SubFoodDay).val()};
f(d.ajaxLink.Exec,c,a.Button.SubExecSearch,h);break;case a.Button.MainWeight:c={RQ:d.ajaxVal.Weight,DATE:b(a.Input.SubWeightDay).val()};f(d.ajaxLink.Weight,c,a.Button.SubWeightSearch,h);break;case a.Button.MainDay:c={RQ:d.ajaxVal.Day};f(d.ajaxLink.Day,c,a.Button.MainDay,h);break;case a.Button.MainMonth:c={RQ:d.ajaxVal.Month};f(d.ajaxLink.Month,c,a.Button.MainMonth,h);break;case a.Button.SubmitFoodExecSearch:b(a.Div.ModalFoodExec).find("p").text()===d.TextVal.SubmitExec?(c={RQ:d.ajaxVal.ExecList,MODE:d.ajaxVal.ExecListVal,
VALUE:b(a.Input.SubmitFoodExecSearch).val()},f(d.ajaxLink.ExecList,c,a.Button.SubmitFoodExecSearch,h)):(c={RQ:d.ajaxVal.FoodList,MODE:d.ajaxVal.FoodListVal,VALUE:b(a.Input.SubmitFoodExecSearch).val()},f(d.ajaxLink.FoodList,c,a.Button.SubmitFoodExecSearch,h));break;case a.Button.SubmitFoodExec:v();break;case a.Button.SubmitWeight:q(a.Button.SubmitWeight)&&(c={RQ:d.ajaxVal.SubmitWeight,DATE:b(a.Input.SubmitWeightDay).val(),VALUE:b(a.Input.SubmitWeight).val()},f(d.ajaxLink.SubmitWeight,c,a.Button.SubmitWeight,
h));break;case a.Button.SubmitCategoryFood:q(a.Button.SubmitCategoryFood)&&(c={RQ:d.ajaxVal.SubmitFoodCategory,FOOD:b(a.Input.SubmitCategoryFoodName).val(),VALUE:b(a.Input.SubmitCategoryFoodValue).val()},f(d.ajaxLink.SubmitFoodExec,c,a.Button.SubmitCategoryFood,h));break;case a.Button.SubmitCategoryExec:q(a.Button.SubmitCategoryExec)&&(c={RQ:d.ajaxVal.SubmitExecCategory,EXEC:b(a.Input.SubmitCategoryExecName).val(),VALUE:b(a.Input.SubmitCategoryExecValue).val()},f(d.ajaxLink.SubmitFoodExec,c,a.Button.SubmitCategoryExec,
h))}}function h(c,g){switch(c){case a.Button.SubFoodSearch:var e=b(a.Table.FoodFood).find("tbody");e.empty();b(e).append("<tr><th>\ub0a0\uc9dc</th><th>\uc74c\uc2dd\uba85</th><th>\uc778\ubd84</th><th>\uc0ad\uc81c</th></tr>");g.map(function(a){b(e).append("<tr>\t<td>"+a.diet_date+"</td><td>"+a.category_name+"</td><td>"+a.value+'</td><td><button  class="'+d.Button.FoodDelNodeClassName+'" value="'+a.rowid+'">\uc0ad\uc81c</button></td>\t</tr>')});b(d.Button.FoodDelNodeClass).click(function(){r(b(this))});
break;case a.Button.SubExecSearch:e=b(a.Table.FoodExec).find("tbody");e.empty();b(e).append("<tr><th>\ub0a0\uc9dc</th><th>\uc6b4\ub3d9\uba85</th><th>\uc2dc\uac04</th><th>\uc0ad\uc81c</th></tr>");g.map(function(a){b(e).append("<tr>\t<td>"+a.diet_date+"</td><td>"+a.category_name+"</td><td>"+a.value+'</td><td><button  class="'+d.Button.ExecDelNodeClassName+'" value="'+a.rowid+'">\uc0ad\uc81c</button></td>\t</tr>')});b(d.Button.ExecDelNodeClass).click(function(){r(b(this))});break;case a.Button.SubWeightSearch:e=
b(a.Table.Weight).find("tbody");e.empty();b(e).append("<tr><th>\ub0a0\uc9dc</th><th>\ubab8\ubb34\uac8c</th><th>\uc99d\uac10</th></tr>");g.map(function(a,c){b(e).append("<tr>\t<td>"+a.diet_date+"</td><td>"+a.value+"</td><td>"+(a.value-(g[c+1]?g[c+1].value:a.value)).toFixed(1)+"</td>\t</tr>")});b(d.Button.WeigthDelNodeClass).click(function(){r(b(this))});break;case a.Button.MainDay:e=b(a.Table.Day).find("tbody");e.empty();b(e).append("<tr><th>\ub0a0\uc9dc</th><th>+kcal</th><th>-kcal</th><th>\uc9c0\ubc29</th></tr>");
g.map(function(a){b(e).append("<tr><td>"+a.diet_date+"</td><td>"+a.food_sum+"</td><td>"+a.exec_sum+"</td><td>"+a.sum_gram+"</td> </tr>")});l.graphDraw(g,a.Graph.DayCal,d.TextVal.GraphHeight);l.graphDraw(g,a.Graph.DayFat,d.TextVal.GraphHeight);break;case a.Button.MainMonth:e=b(a.Table.Month).find("tbody");e.empty();b(e).append("<tr><th>\ub144\uc6d4</th><th>\ubb34\uac8c</th>");g.map(function(a){b(e).append("<tr>\t<td>"+a.diet_mon+"</td><td>"+a.avg_val+"</td></tr>")});l.graphDraw2(g,a.Graph.Month,d.TextVal.GraphHeight);
break;case a.Button.SubmitFoodExecSearch:e=b(a.Table.SubmitFoodExec).find("tbody");e.empty();b(e).append("<tr><th>\uc120\ud0dd</th><th>\ud6a8\uc728</th>");g.map(function(a){b(e).append('<tr>\t<td><button  class="'+d.Button.FoodExecSelNodeClassName+'" value="'+a.category_id+'">'+a.category_name+"</button></td><td>"+a.category_value+"</td>\t</tr>")});b(d.Button.FoodExecSelNodeClass).click(function(){w(b(this))});break;case a.Button.SubmitFoodExec:window.history.back();k(a.Button.MainFood);break;case a.Button.SubmitWeight:window.history.back();
k(a.Button.SubWeightSearch);break;case a.Button.SubmitCategoryFood:window.history.back();break;case a.Button.SubmitCategoryExec:window.history.back()}}function r(c){switch(c.attr("class")){case d.Button.FoodDelNodeClassName:c={RQ:d.ajaxVal.DelFoodExec,ID:b(c).val()};f(d.ajaxLink.DelFoodExec,c,a.Button.SubFoodSearch,k);break;case d.Button.ExecDelNodeClassName:c={RQ:d.ajaxVal.DelFoodExec,ID:b(c).val()};f(d.ajaxLink.DelFoodExec,c,a.Button.SubExecSearch,k);break;case d.Button.WeigthDelNodeClassName:c=
{RQ:d.ajaxVal.Weight,ID:b(c).val()},f(d.ajaxLink.DelWeight,c,a.Button.SubWeightSearch,h)}}function w(c){var g=c.val();c=c.text();if(!1===Array.from(b(a.Table.SubmitSetFoodExec).find("tr")).some(function(a){return b(a).find("button").val()===g})){var e=b(a.Table.SubmitSetFoodExec).find("tbody"),f=b('<tr>\t<td><button  class="'+d.Button.FoodExecDelNodeClassName+'" value="'+g+'">'+c+'</button></td><td contenteditable="true">1</td>\t</tr>');b(e).append(f);f.find("button").click(function(){b(f).remove()})}}
function v(){var c=Array.from(b(a.Table.SubmitSetFoodExec).find("tr"));c.shift();if(0<c.length)if(c.every(function(a){return p(b(a).find("td:eq(1)").text(),m.OnlyNumber)})&&c.every(function(a){return 0<b(a).find("button:eq(0)").val().length})){var g=b(a.Input.SubmitFoodExecDay).val();c.map(function(e,k){rqdata={RQ:d.ajaxVal.SubmitFoodExec,DATE:g,CATEGORY:b(e).find("button:eq(0)").val(),VALUE:b(e).find("td:eq(1)").text()};k===c.length-1?f(d.ajaxLink.SubmitFoodExec,rqdata,a.Button.SubmitFoodExec,h):
f(d.ajaxLink.SubmitFoodExec,rqdata,a.Button.SubmitFoodExec,null)});b(a.Table.SubmitSetFoodExec).find("tr:gt(0)").remove()}else console.log("\uc624\ub958 \ubc1c\uc0dd");else console.log("\uc120\ud0dd\ub418\uc9c0 \uc54a\uc74c")}function f(a,d,e,f){b.ajax({url:a,type:"POST",data:d,beforeSend:function(a){a.overrideMimeType&&a.overrideMimeType("application/json")},dataType:"json",scriptCharset:"utf-8",error:function(a,b,c){}}).done(function(a){if(null!==f)return f(e,a)}).fail(function(){console.log("\uc1a1\uc218\uc2e0 \uc2e4\ud328");
window.location="/Diet/Login"})}function q(c){switch(c){case a.Button.SubmitWeight:if(!b(a.Input.SubmitWeight).val())return b(a.Input.SubmitWeight).attr("placeholder","\uc785\ub825\ud574\uc8fc\uc138\uc694"),b(a.Input.SubmitWeight).focus(),!1;c=p(b(a.Input.SubmitWeight).val(),m.OnlyNumber);b(a.Input.SubmitWeight).val(c);return!0;case a.Button.SubmitCategoryFood:if(!b(a.Input.SubmitCategoryFoodName).val())return b(a.Input.SubmitCategoryFoodName).attr("placeholder","\uc785\ub825\ud574\uc8fc\uc138\uc694"),
b(a.Input.SubmitCategoryFoodName).focus(),!1;c=p(b(a.Input.SubmitCategoryFoodValue).val(),m.OnlyNumber);b(a.Input.SubmitCategoryFoodValue).val(c);return b(a.Input.SubmitCategoryFoodValue).val()?!0:(b(a.Input.SubmitCategoryFoodValue).attr("placeholder","\uc785\ub825\ud574\uc8fc\uc138\uc694"),b(a.Input.SubmitCategoryFoodValue).focus(),!1);case a.Button.SubmitCategoryExec:if(!b(a.Input.SubmitCategoryExecName).val())return b(a.Input.SubmitCategoryExecName).attr("placeholder","\uc785\ub825\ud574\uc8fc\uc138\uc694"),
b(a.Input.SubmitCategoryExecName).focus(),!1;c=p(b(a.Input.SubmitCategoryExecValue).val(),m.OnlyNumber);b(a.Input.SubmitCategoryExecValue).val(c);return b(a.Input.SubmitCategoryExecValue).val()?!0:(b(a.Input.SubmitCategoryExecValue).attr("placeholder","\uc785\ub825\ud574\uc8fc\uc138\uc694"),b(a.Input.SubmitCategoryExecValue).focus(),!1)}}function t(c,d){var e=[];switch(c){case a.Graph.Month:e=[["","\uccb4\uc911"]];b.each(d,function(){var a=[this.diet_mon,parseInt(this.avg_val)];e.push(a)});break;
case a.Graph.DayCal:e=[["","\uc12d\ucde8\uce7c\ub85c\ub9ac","\uc18c\ubaa8\uce7c\ub85c\ub9ac"]];b.each(d,function(){var a=[this.diet_date,parseInt(this.food_sum),parseInt(this.exec_sum)];e.push(a)});break;case a.Graph.DayFat:e=[["","\uc9c0\ubc29\uc99d\uac10\ub7c9"]],b.each(d,function(){var a=[this.diet_date,parseInt(this.sum_gram)];e.push(a)})}return e}function p(a,b){switch(b){case m.OnlyChar:var c=/[^(\uac00-\ud7a3\u3131-\u314e\u314f-\u3163a-zA-Z0-9)]/gi;break;case m.OutSpecial:c=/[\{\}\[\]\/?.,;:|\)*~`!^\-_+<>@#$%&\\=\('"]/gi;
break;case m.OnlyNumber:c=/[^\d\.]/g}c.test(a)&&(a=a.replace(c,""));return a}google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(b(function(){l.graphDraw}));var d={ajaxLink:{Food:"/Diet/Select",Exec:"/Diet/Select",Weight:"/Diet/Select",Day:"/Diet/Select",Month:"/Diet/Select",FoodList:"/Diet/Select",ExecList:"/Diet/Select",SubmitFoodExec:"/Diet/Update",SubmitWeight:"/Diet/Update",DelFoodExec:"/Diet/Delete",DelWeight:""},ajaxVal:{Food:"LIST_FOOD",Exec:"LIST_EXEC",
Weight:"LIST_WEIGHT",Day:"LIST_STATDAY",Month:"LIST_STATMONTH",FoodList:"LIST_CATEGORY",ExecList:"LIST_CATEGORY",FoodListVal:"FOOD",ExecListVal:"EXEC",SubmitFoodExec:"UPDATE_FOODEXEC",SubmitWeight:"UPDATE_WEIGHT",DelFoodExec:"DELETE_FOODEXEC",DelmitWeight:"DELETE_WEIGHT",SubmitFoodCategory:"UPDATE_CATEGORYFOOD",SubmitExecCategory:"UPDATE_CATEGORYEXEC"},TextVal:{SubmitFood:"\uc74c\uc2dd",SubmitExec:"\uc6b4\ub3d9",GraphHeight:900},Button:{FoodDelNodeClass:".delete.button.food",FoodDelNodeClassName:"delete button food",
ExecDelNodeClass:".delete.button.exec",ExecDelNodeClassName:"delete button exec",WeigthDelNodeClass:".delete.button.weight",WeigthDelNodeClassName:"delete button weight",FoodExecSelNodeClass:".select.button.foodexec",FoodExecSelNodeClassName:"select button foodexec",FoodExecDelNodeClass:".delete.button.foodexec",FoodExecDelNodeClassName:"delete button foodexec"}},a={Div:{ModalFoodExec:"#modal-submit-foodexec",ModalWeight:"#modal-submit-weight",ModalCategory:"#modal-submit-category",TableHeadName:"table-head"},
Button:{MainFood:"#button-food",MainWeight:"#button-weight",MainDay:"#button-day",MainMonth:"#button-month",SubFoodSearch:"#button-food-search",SubExecSearch:"#button-exec-search",SubWeightSearch:"#button-weight-search",SubmitFoodExec:"#button-submit-foodexec",SubmitFoodExecSearch:"#button-submit-foodexec-search",SubmitWeight:"#button-submit-weight",SubmitCategoryFood:"#button-submit-food-category",SubmitCategoryExec:"#button-submit-exec-category",cancel:".cancel"},ButtonModal:{SubFoodFood:"#button-food-food",
SubFoodExec:"#button-food-exec",SubWeightWeight:"#button-weight-weight",SubCategory:"#button-category"},Input:{SubFoodDay:"#food-datepicker",SubWeightDay:"#weight-datepicker",SubmitFoodExecDay:"#input-submit-foodexec-day",SubmitFoodExecSearch:"#input-submit-foodexec-search",SubmitWeight:"#input-submit-weight",SubmitWeightDay:"#input-submit-weight-day",SubmitCategoryFoodName:"#input-submit-category-food-name",SubmitCategoryFoodValue:"#input-submit-category-food-qt",SubmitCategoryExecName:"#input-submit-category-exec-name",
SubmitCategoryExecValue:"#input-submit-category-exec-qt"},Table:{FoodFood:"#food-food",FoodExec:"#food-exec",Weight:"#weight-weight",Day:"#day-cal",Month:"#month-cal",SubmitFoodExec:"#submit-foodexec-table",SubmitSetFoodExec:"#submit-foodexec-set-table"},Graph:{Month:"#month-graph-weight",DayCal:"#day-graph-cal",DayFat:"#day-graph-fat"}},m={OnlyNumber:"1",OnlyChar:"2",OutSpecial:"3"};l.graphDraw=function(a,b,d){a=t(b,a);a=google.visualization.arrayToDataTable(a);(new google.visualization.BarChart(document.getElementById(b.replace("#",
"")))).draw(a,{})};l.graphDraw2=function(a,b,d){a=t(b,a);a=google.visualization.arrayToDataTable(a);(new google.visualization.LineChart(document.getElementById(b.replace("#","")))).draw(a,{title:"",chartArea:{top:20,width:"70%",height:"90%"},hAxis:{minValue:0},orientation:"vertical",curveType:"function"})};l.run=function(){u()};return l}(window.SipuDiet||{},$);SipuDiet.run();